<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="pos_referral_system.OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('receipt-change')]" position="after">

            <!-- Show only if we have referral data -->
            <t t-if="props.data.receipt_referral_data">
                <!-- Show generated code -->
                <t t-if="props.data.receipt_referral_data.generated_code">
                    <div style="margin: 10px 0; padding: 10px; border-top: 1px dashed #000; border-bottom: 1px dashed #000;">
                        <div style="font-weight: bold; text-align: center; margin-bottom: 8px;">
                            REFERRAL CODE GENERATED
                        </div>
                        <table width="100%" style="font-size: 90%;">
                            <tr>
                                <td width="50%">Reference #:</td>
                                <td style="text-align: right; font-weight: bold;">
                                    <t t-esc="props.data.receipt_referral_data.generated_code"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align: center; font-style: italic; padding-top: 5px;">
                                    Share this code with friends for rewards!
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>

                <!-- Show used code -->
                <t t-if="props.data.receipt_referral_data.used_code">
                    <div style="margin: 10px 0; padding: 10px; border-top: 1px dashed #000; border-bottom: 1px dashed #000;">
                        <div style="font-weight: bold; text-align: center; margin-bottom: 8px;">
                            REFERRAL CODE APPLIED
                        </div>
                        <table width="100%" style="font-size: 90%;">
                            <tr>
                                <td width="50%">Reference #:</td>
                                <td style="text-align: right; font-weight: bold;">
                                    <t t-esc="props.data.receipt_referral_data.used_code"/>
                                </td>
                            </tr>
                            <t t-if="props.data.receipt_referral_data.discount_amount and props.data.receipt_referral_data.discount_amount > 0">
                                <tr>
                                    <td>Referral Discount:</td>
                                    <td style="text-align: right; font-weight: bold; color: green;">
                                        AED <t t-esc="props.data.receipt_referral_data.discount_amount.toFixed(2)"/>
                                    </td>
                                </tr>
                            </t>
                        </table>
                    </div>
                </t>
            </t>

        </xpath>
    </t>
</templates>